# IKPA Hackathon Strategy: Winning "Ship Your Best Self"

## Commit to Change: An AI Agents Hackathon

**Target Prizes:**
- Financial Health: $5,000
- Best Use of Opik: $5,000
- **Maximum Prize: $10,000**

**Timeline:** 4 weeks (January 13 - February 10, 2026)

---

## Executive Summary

### Core Thesis: The Five Failure Modes

The 91% resolution failure rate is NOT a failure of intent or data availability‚Äîit's a **failure of executive function architecture** caused by five distinct failure modes:

| Failure Mode | What Happens | IKPA Agent |
|--------------|--------------|------------|
| **Invisible Leakage** | Money disappears through forgotten subscriptions | **Shark Auditor** |
| **Failure Spiral** | One slip cascades into total abandonment | **GPS Re-Router** |
| **Temporal Disconnect** | Future self feels like a stranger | **Future Self Simulator** |
| **Cultural Blindness** | Western apps shame family support | **Ubuntu Manager** |
| **Commitment Decay** | Goals abandoned without stakes or accountability | **Commitment Device Engine** |

Each failure mode is defeated by one specialized IKPA agent.

### Paradigm Shift

| Legacy Apps (Mint, YNAB) | IKPA (Agentic) |
|--------------------------|----------------|
| Pull-based (user logs in) | Push-based (agent intervenes) |
| Historical data | Real-time interception |
| Visualization only | Execution (negotiation, transfers) |
| User must decide | Agent acts autonomously |
| Western-centric | Africa-aware (family obligations) |

### Why IKPA Will Win

1. **Execution over Visualization** - Agents DO things, not just show things
2. **Five Failure Modes Framework** - Each agent defeats a specific failure mode
3. **Opik Full Integration** - Distributed tracing + G-Eval + MetaPromptOptimizer + GEPA
4. **Unique Differentiation** - Africa-specific context, Future Self conversations (MIT research)
5. **Commitment Device Engine** - Stakes and accountability to 3x goal completion rates

---

## Part 1: The Five Failure Modes Framework

Understanding the "user hardware" (human brain) failure modes is critical to designing effective interventions.

### Failure Mode 1: Invisible Leakage
**‚Üí Defeated by: Shark Auditor ("Trash Collector")**

**What:** Money silently drains through forgotten subscriptions, zombie charges, and unnoticed fees.

**Why It Happens:** Subscription models exploit our "set and forget" psychology. A ‚Ç¶3,000/month charge feels trivial, but ‚Ç¶36,000/year is significant. Users don't consciously choose to keep paying‚Äîthey simply forget to cancel.

**Statistics:**
- Average user has 12 forgotten subscriptions
- 84% of people underestimate their monthly subscription costs
- "Zombie subscriptions" (unused but still charging) cost users an average of $273/year

**Why Traditional Apps Fail:** They show lists of transactions. Users must scroll, identify, remember, and act. The cognitive load is too high.

**IKPA Solution:** The **Shark Auditor** uses regex pattern matching and anomaly detection to surface zombie subscriptions with **annualized framing** ("‚Ç¶3,000/month ‚Üí ‚Ç¶36,000/year. That's 7% of your rent.") and a **Tinder-style swipe UI** for instant decisions.

---

### Failure Mode 2: Failure Spiral
**‚Üí Defeated by: GPS Re-Router ("Wrong Turn Recovery")**

**What:** One budget slip triggers guilt ‚Üí avoidance ‚Üí abandonment ‚Üí total failure.

**Research Basis:** The "What-The-Hell Effect" (Polivy & Herman). After one perceived failure, people think "I've already blown it, might as well continue."

**Why It Happens:** Traditional apps frame budget exceeds as failures. This triggers shame, which triggers avoidance (Ostrich Effect), which triggers total resolution abandonment.

**Statistics:**
- 88% of resolutions fail within 2 weeks
- First slip is the #1 predictor of total abandonment
- Users who recover from first slip are 3x more likely to succeed

**Why Traditional Apps Fail:** Red alerts, warning banners, "You're over budget!" messages reinforce failure identity. They create pain, not paths forward.

**IKPA Solution:** The **GPS Re-Router** reframes slips as "wrong turns, not dead ends." It automatically recalculates probability of goal achievement and presents three recovery paths without judgment: "You made a wrong turn. Let's recalculate."

---

### Failure Mode 3: Temporal Disconnect
**‚Üí Defeated by: Future Self Simulator ("Time Machine")**

**What:** Users feel disconnected from their future selves. Future-Aisha feels like a stranger to Present-Aisha.

**Research Basis:** MIT Media Lab's "Future You" project (2024). Users who interact with AI-generated future selves are **16% more likely to save**.

**Why It Happens:** The brain's limbic system (immediate gratification) is evolutionarily older than the prefrontal cortex (long-term planning). Hyperbolic discounting causes us to overvalue immediate rewards.

**Statistics:**
- fMRI studies show future self activates "stranger" brain regions
- 16% increase in savings after future self interaction (MIT)
- Dual-path visualizations increase commitment by 23%

**Why Traditional Apps Fail:** Graphs showing "projected savings in 20 years" don't create emotional connection. Numbers don't motivate; narratives do.

**IKPA Solution:** The **Future Self Simulator** runs Dual-Path Monte Carlo simulations and generates personalized **Letters from 2045** using a 60-year-old persona prompt. A time slider lets users see their two futures at 6mo, 1yr, 5yr, 10yr, and 20yr.

---

### Failure Mode 4: Cultural Blindness
**‚Üí Defeated by: Ubuntu Manager ("Social Capital Recognizer")**

**What:** Western fintech apps frame family support as "financial leakage" instead of "social capital investment."

**Why It Matters:** In African cultures, supporting family is a VALUE, not a problem. Apps that shame family obligations alienate users and create guilt around culturally mandated behaviors.

**Ubuntu Philosophy:** "I am because we are." Financial success in African context includes family prosperity, not just individual wealth.

**Statistics:**
- Average African professional supports 4-6 family members
- Family support averages 15-35% of net income
- 67% of African users abandon Western finance apps due to "irrelevant advice"

**Why Traditional Apps Fail:** They categorize family transfers as "gifts" or "other"‚Äînegative budget items. This creates psychological conflict between cultural identity and financial software.

**IKPA Solution:** The **Ubuntu Manager** categorizes family transfers as "Social Capital Investment" with a Dependency Ratio health gauge. It provides non-judgmental adjustments for family emergencies and tracks social capital alongside financial capital.

---

### Failure Mode 5: Commitment Decay
**‚Üí Defeated by: Commitment Device Engine ("Stakes Enforcer")**

**What:** Initial motivation fades without external accountability or stakes. Users set goals with enthusiasm but abandon them when faced with temptation or competing priorities.

**Research Basis:** Dean Karlan's precommitment research; stickK.com commercial validation; Kahneman & Tversky's loss aversion studies.

**Why It Happens:** Without skin in the game, goals feel optional. The psychological cost of abandonment is too low. "I can always start again next month." The pain of missing a goal without stakes is fleeting‚Äîeasily rationalized away.

**Statistics:**
- Users with stakes are 3x more likely to achieve goals (stickK.com data)
- Social accountability increases success rates by 65%
- Loss aversion is 2x stronger than gain motivation (Kahneman & Tversky)
- 78% of goals with referees are achieved vs. 35% without

**Why Traditional Apps Fail:** They track goals but create no consequence for failure. A missed target just becomes a sad statistic‚Äîa red number on a chart. There's no accountability partner, no referee, no stakes. Users can simply reset and try again, perpetuating the cycle.

**IKPA Solution:** The **Commitment Device Engine** creates real stakes through three mechanisms:
1. **Social Accountability** - Designate a referee who verifies goal completion and receives progress notifications
2. **Anti-Charity Stakes** - Pre-commit funds to donate to a cause you *oppose* if you fail (loss aversion weaponized for good)
3. **Loss Pool** - Pre-committed funds locked until goal achieved, creating tangible cost for abandonment

The engine transforms vague intentions into binding commitments with real consequences.

---

## Part 2: Feature Specifications

### 2.1 The Shark Auditor (Automated Savings)
**Mission:** Defeat Invisible Leakage

#### Technical Implementation

**Trigger Mechanism:**
- Daily cron job scans transaction history
- Webhook on new recurring charge detection
- User-requested audit

**Cognitive Architecture:**

```typescript
// SHARK AUDITOR: Find and eliminate zombie subscriptions

// Step 1: Regex Pattern Matching
const subscriptionPatterns = [
  /netflix|spotify|amazon prime|youtube premium/i,
  /DSTV|GOTV|Showmax/i,
  /gym|fitness|wellness/i,
  /cloud|storage|backup/i
];

// Step 2: Anomaly Detection for "Zombie Subscriptions"
// Usage-based detection: Subscription active but no related activity
const zombieDetection = {
  hasActiveCharge: true,
  lastUsageDate: '2025-08-15', // 5 months ago
  status: 'ZOMBIE'
};

// Step 3: Annualized Framing (Cognitive Reframe)
const framing = {
  monthly: '‚Ç¶3,000/month',
  annual: '‚Ç¶36,000/year',
  context: "That's 7% of your monthly rent.",
  impact: "Canceling saves you ‚Ç¶36,000 this year."
};

// Step 4: Tinder-Style Swipe UI
const swipeOptions = {
  swipeLeft: 'Cancel subscription',
  swipeRight: 'Keep subscription',
  tapForDetails: 'View usage history'
};
```

**Annualized Framing Examples:**
- "$15/month" ‚Üí "$180/year. That's 8% of your rent."
- "‚Ç¶5,000/month" ‚Üí "‚Ç¶60,000/year. That's a weekend trip to Calabar."
- "¬£9.99/month" ‚Üí "¬£120/year. That's 3 months of groceries."

**Opik Metrics:**
- `SubscriptionDetectionAccuracy`: True positives / (True positives + False positives)
- `CancellationRate`: Subscriptions cancelled / Subscriptions surfaced
- `AnnualSavingsGenerated`: Sum of cancelled subscription values

---

### 2.2 The GPS Re-Router (Failure Management)
**Mission:** Defeat the Failure Spiral

#### Technical Implementation

**Trigger Mechanism:**
- Webhook on budget threshold exceed (80%, 100%, 120%)
- Manual trigger ("I overspent, help me recover")
- Scheduled weekly goal check

**Cognitive Architecture:**

```typescript
// GPS RE-ROUTER: Turn wrong turns into recalculations

// Step 1: Detect Budget Exceed
const budgetStatus = {
  category: 'Entertainment',
  budgeted: 50000,
  spent: 72000,
  overagePercent: 44,
  trigger: 'BUDGET_EXCEEDED'
};

// Step 2: Probability Engine Recalculation
const goalImpact = {
  goalName: 'House Down Payment',
  previousProbability: 0.78,
  newProbability: 0.71,
  probabilityDrop: 0.07,
  message: 'This spending reduced your goal probability from 78% to 71%.'
};

// Step 3: Generate 3 Recovery Paths
const recoveryPaths = [
  {
    name: 'Time Adjustment',
    description: 'Extend goal deadline by 3 weeks',
    newProbability: 0.78,
    effort: 'Low'
  },
  {
    name: 'Rate Adjustment',
    description: 'Increase weekly savings by ‚Ç¶5,000 for next month',
    newProbability: 0.80,
    effort: 'Medium'
  },
  {
    name: 'Freeze Protocol',
    description: 'Pause entertainment spending for 2 weeks',
    newProbability: 0.82,
    effort: 'High'
  }
];

// Step 4: Non-Judgmental Framing
const message = {
  tone: 'Supportive',
  headline: "You made a wrong turn. Let's recalculate.",
  subtext: "This isn't failure‚Äîit's navigation. Choose your recovery path:",
  NO_shame_words: ['failed', 'mistake', 'problem', 'wrong', 'bad']
};
```

**Non-Judgmental Framing:**
- ‚ùå "You exceeded your budget by 44%"
- ‚úÖ "You made a wrong turn. Let's recalculate your route."
- ‚ùå "You failed to stay within your entertainment budget"
- ‚úÖ "Your entertainment spending took an unexpected detour. Here are 3 ways to get back on track."

**Opik Metrics:**
- `RecoveryPathSelection`: Which path users choose most often
- `GoalSurvivalRate`: Users who don't abandon goal after slip
- `TimeToRecovery`: Hours between slip and recovery path selection

---

### 2.3 The Future Self Simulator (Emotional Motivation)
**Mission:** Defeat Temporal Disconnect

#### Technical Implementation

**Trigger Mechanism:**
- User requests future self conversation
- Weekly scheduled "letter from the future"
- After major financial decision

**Cognitive Architecture:**

```typescript
// FUTURE SELF SIMULATOR: Bridge the temporal gap

// Step 1: Dual-Path Monte Carlo Simulation
const simulation = {
  currentBehavior: {
    savingsRate: 0.08,
    projectedNetWorth: {
      '1_year': 450000,
      '5_years': 2100000,
      '10_years': 4800000,
      '20_years': 12000000
    }
  },
  withIKPA: {
    savingsRate: 0.18,
    projectedNetWorth: {
      '1_year': 520000,
      '5_years': 3200000,
      '10_years': 8500000,
      '20_years': 28000000
    }
  },
  difference_20yr: 16000000 // ‚Ç¶16M difference
};

// Step 2: Generate "Letter from 2045"
const letterPrompt = `
You are writing as the user's 60-year-old future self.
Current user data: ${JSON.stringify(userData)}
Simulation results: ${JSON.stringify(simulation)}

Write a heartfelt, personal letter from their 60-year-old self.
Include specific details from their current goals and situation.
If they're on track: celebrate and encourage.
If they're struggling: empathize and provide hope.

IMPORTANT: Make it feel REAL. Reference their specific goals,
their city, their dreams. This should feel like a letter from
a future that actually knows them.
`;

// Step 3: Time Slider Visualization
const timeSlider = {
  positions: ['6mo', '1yr', '5yr', '10yr', '20yr'],
  currentPosition: '10yr',
  showDualPaths: true,
  animateTransition: true
};

// Example Letter Output:
const letterFrom2045 = `
Dear Aisha,

I'm writing this from the balcony of our flat in Victoria Island.
Yes, OUR flat‚Äîwe own it now, mortgage-free.

I know right now you're wondering if the sacrifices are worth it.
You're 28, everyone's going to Dubai, and you're cooking at home
to hit your savings target. I remember that feeling.

Here's what I can tell you from 60:
That ‚Ç¶20,000 you saved instead of buying those shoes in January 2026?
It became ‚Ç¶180,000 by the time I'm writing this.

But it's not just about the money. It's about who you become.
The discipline you're building right now? It compounds too.

Keep going. I'm proof it works.

With love from your future,
Aisha (Age 60)
`;
```

**Visualization Features:**
- **Time Slider**: Drag between 6mo ‚Üí 1yr ‚Üí 5yr ‚Üí 10yr ‚Üí 20yr
- **Dual Path View**: Side-by-side comparison of "Current Path" vs "IKPA Path"
- **Animation**: Smooth transitions showing wealth divergence over time
- **Milestone Markers**: Show when major goals become achievable

**Addon: Shareable Story Cards**

Generate beautiful, shareable cards that capture the user's financial journey for social media inspiration:

```typescript
// SHAREABLE STORY CARDS: Viral potential for organic growth

interface StoryCard {
  type: 'future_self' | 'commitment' | 'milestone' | 'recovery';
  userId: string;
  generatedAt: Date;

  // Visual elements
  headline: string;           // "My 60-year-old self wrote me a letter"
  subheadline: string;        // "Here's what changed everything"
  keyMetric: {
    label: string;            // "Potential Net Worth Difference"
    value: string;            // "‚Ç¶16,000,000"
  };
  quote?: string;             // Excerpt from future self letter

  // Sharing metadata
  shareUrl: string;
  platforms: ('twitter' | 'linkedin' | 'whatsapp' | 'instagram')[];
  hashtags: string[];         // ['#IKPA', '#FinancialFreedom', '#FutureSelf']
}

// Story Card Templates
const storyCardTemplates = {
  future_self: {
    headline: "I talked to my 60-year-old self",
    subheadline: "The conversation that changed my financial future",
    gradient: ['#667eea', '#764ba2'],
    includeQuote: true
  },
  commitment: {
    headline: "I put my money where my goals are",
    subheadline: "{{stakeType}} activated for {{goalName}}",
    gradient: ['#f093fb', '#f5576c'],
    includeReferee: true
  },
  milestone: {
    headline: "Goal Achieved! üéâ",
    subheadline: "{{goalName}} - {{daysToComplete}} days of commitment",
    gradient: ['#4facfe', '#00f2fe'],
    includeStats: true
  },
  recovery: {
    headline: "I made a wrong turn. Then I recalculated.",
    subheadline: "Back on track with {{recoveryPath}}",
    gradient: ['#43e97b', '#38f9d7'],
    includeMessage: true
  }
};

// Generate shareable card
async function generateStoryCard(
  userId: string,
  type: StoryCard['type'],
  context: Record<string, any>
): Promise<StoryCard> {
  const template = storyCardTemplates[type];
  const userData = await getUserData(userId);

  return {
    type,
    userId,
    generatedAt: new Date(),
    headline: template.headline,
    subheadline: interpolate(template.subheadline, context),
    keyMetric: generateKeyMetric(type, context),
    quote: type === 'future_self' ? context.letterExcerpt : undefined,
    shareUrl: generateShareUrl(userId, type),
    platforms: ['twitter', 'linkedin', 'whatsapp', 'instagram'],
    hashtags: ['#IKPA', '#FinancialFreedom', `#${type.replace('_', '')}`]
  };
}
```

**Story Card Triggers:**
- **Future Self**: After reading letter from 2045 (with user consent)
- **Commitment**: When user creates a commitment with stakes
- **Milestone**: When goal is verified as achieved
- **Recovery**: When user successfully completes a recovery path

**Privacy Controls:**
- All cards anonymize specific amounts by default (shows percentages/ratios)
- User can choose to reveal actual numbers
- No personal data included without explicit opt-in
- Share preview before posting

**Opik Metrics:**
- `LetterEngagement`: Time spent reading letter
- `PostLetterSavingsChange`: Savings rate change within 7 days
- `ToneEmpathy`: G-Eval score (1-5) for emotional resonance
- `StoryCardShares`: Number of cards shared by platform
- `ViralCoefficient`: New signups attributed to shared cards

---

### 2.4 The Ubuntu Manager (Cultural Context)
**Mission:** Defeat Cultural Blindness

#### Technical Implementation

**Trigger Mechanism:**
- Transaction categorized as family transfer
- User adds family obligation
- Monthly dependency ratio calculation

**Cognitive Architecture:**

```typescript
// UBUNTU MANAGER: Recognize social capital

// Step 1: Smart Categorization
const transactionReframe = {
  originalCategory: 'Gifts/Transfers',
  newCategory: 'Social Capital Investment',
  subcategories: [
    'Parent Support',
    'Sibling Education',
    'Extended Family Emergency',
    'Community Contribution (Ajo/Esusu)'
  ]
};

// Step 2: Dependency Ratio Calculation
const dependencyRatio = {
  formula: '(Total Family Support / Net Income) * 100',
  components: {
    parentSupport: 40000,
    siblingEducation: 25000,
    extendedFamily: 10000,
    totalFamilySupport: 75000,
    netIncome: 350000
  },
  ratio: 21.4, // 21.4%
  interpretation: 'Healthy family support level'
};

// Step 3: Risk Gauge (Traffic Light System)
const riskGauge = {
  green: { range: [0, 10], label: 'Sustainable', color: '#22c55e' },
  orange: { range: [10, 35], label: 'Moderate', color: '#f59e0b' },
  red: { range: [35, 100], label: 'Review Needed', color: '#ef4444' },
  currentValue: 21.4,
  currentZone: 'orange',
  message: 'Your family support is at a healthy moderate level.'
};

// Step 4: Non-Judgmental Response to Family Emergency
const familyEmergencyResponse = {
  trigger: 'Mom needs ‚Ç¶100,000 for medical bills',
  validation: "Family comes first‚Äîthat's not a bug, it's a feature of who you are.",
  adjustments: [
    {
      option: 'Use emergency fund (recommended)',
      impact: 'Emergency fund: ‚Ç¶250,000 ‚Üí ‚Ç¶150,000',
      recovery: 'Rebuild in 3 months at current savings rate'
    },
    {
      option: 'Adjust goal timeline',
      impact: 'House goal: Dec 2026 ‚Üí Feb 2027',
      recovery: 'No monthly budget change needed'
    },
    {
      option: 'Temporary savings reduction',
      impact: 'This month: ‚Ç¶50,000 ‚Üí ‚Ç¶25,000',
      recovery: 'Return to normal next month'
    }
  ],
  insight: "Your dependency ratio will temporarily rise to 28%‚Äîstill in the healthy orange zone."
};
```

**Cultural Features:**
- **Ajo/Esusu Tracking**: Rotating savings group support
- **Multi-Currency**: NGN, GHS, KES, ZAR, EGP, USD
- **Family Obligation Calendar**: Anticipate regular support needs
- **Social Capital Score**: Track family support as investment, not expense

**Opik Metrics:**
- `CulturalSensitivity`: G-Eval score for cultural appropriateness
- `DependencyRatioHealth`: Ratio staying in healthy range
- `FamilyEmergencyRecoveryTime`: Days to return to normal savings rate

---

### 2.5 The Commitment Device Engine (Accountability System)
**Mission:** Defeat Commitment Decay

#### Technical Implementation

**Trigger Mechanism:**
- User creates a new goal
- Goal milestone approaches (7 days, 3 days, 1 day)
- Referee verification request
- Stake enforcement deadline

**Cognitive Architecture:**

```typescript
// COMMITMENT DEVICE ENGINE: Create real stakes for goals

// Step 1: Commitment Contract Definition
interface CommitmentContract {
  goalId: string;
  userId: string;
  stakeType: 'social' | 'anti_charity' | 'loss_pool';
  stakeAmount?: number;          // In user's currency
  antiCharityCause?: string;     // For anti-charity stakes
  refereeId?: string;            // For social accountability
  refereeEmail?: string;         // Referee notification
  verificationMethod: 'self_report' | 'referee_verify' | 'auto_detect';
  deadline: Date;
  status: 'active' | 'pending_verification' | 'succeeded' | 'failed';
}

// Step 2: Stake Type Configurations
const stakeTypes = {
  social: {
    name: 'Social Accountability',
    description: 'Designate a referee who verifies your progress',
    requirements: ['refereeId', 'refereeEmail'],
    enforcement: 'Referee receives weekly updates and final verification request',
    successRate: 0.78  // 78% success with referee
  },
  anti_charity: {
    name: 'Anti-Charity Stakes',
    description: 'Pre-commit funds to a cause you oppose if you fail',
    requirements: ['stakeAmount', 'antiCharityCause'],
    enforcement: 'Funds automatically donated if goal not verified by deadline',
    suggestedCauses: [
      'Political party you oppose',
      'Sports rival team foundation',
      'Organization with opposing values'
    ],
    successRate: 0.85  // Loss aversion is powerful
  },
  loss_pool: {
    name: 'Loss Pool',
    description: 'Lock funds until goal achieved',
    requirements: ['stakeAmount'],
    enforcement: 'Funds locked in escrow, released only on goal completion',
    successRate: 0.72
  }
};

// Step 3: Referee System
interface Referee {
  id: string;
  name: string;
  email: string;
  relationship: 'friend' | 'family' | 'colleague' | 'coach';
  verificationHistory: {
    goalId: string;
    verified: boolean;
    verifiedAt: Date;
    notes?: string;
  }[];
}

const refereeNotifications = {
  onGoalCreated: {
    subject: '{{userName}} needs your help staying accountable!',
    body: `Your friend {{userName}} has set a financial goal and chose you as their referee.

Goal: {{goalName}}
Target: {{targetAmount}}
Deadline: {{deadline}}

You'll receive weekly progress updates and a final verification request.
Your role: Verify whether they actually achieved the goal.

This accountability partnership increases success rates by 65%!`
  },
  weeklyUpdate: {
    subject: '{{userName}}'s progress update',
    body: `{{userName}} is {{progressPercent}}% toward their goal "{{goalName}}".

Current: {{currentAmount}} / {{targetAmount}}
Days remaining: {{daysRemaining}}

Keep encouraging them!`
  },
  verificationRequest: {
    subject: 'Please verify: Did {{userName}} achieve their goal?',
    body: `{{userName}}'s goal deadline has arrived!

Goal: {{goalName}}
Target: {{targetAmount}}
Final Amount: {{finalAmount}}

As their referee, please verify:
[‚úì VERIFIED] - They achieved the goal
[‚úó NOT VERIFIED] - They did not achieve the goal

Your honest verification helps them grow.`
  }
};

// Step 4: Enforcement Logic
async function enforceCommitment(contract: CommitmentContract): Promise<void> {
  const goal = await getGoal(contract.goalId);

  if (contract.status !== 'pending_verification') return;

  const isVerified = await checkVerification(contract);

  if (isVerified) {
    // Success path
    contract.status = 'succeeded';
    if (contract.stakeType === 'loss_pool') {
      await releaseFunds(contract.userId, contract.stakeAmount);
    }
    await notifyUser(contract.userId, 'goal_achieved', {
      goalName: goal.name,
      message: "Congratulations! Your commitment paid off. Your 60-year-old self is smiling."
    });
  } else {
    // Failure path - enforce stakes
    contract.status = 'failed';
    switch (contract.stakeType) {
      case 'anti_charity':
        await processDonation(contract.stakeAmount, contract.antiCharityCause);
        await notifyUser(contract.userId, 'stake_enforced', {
          message: `Your anti-charity stake of ${formatCurrency(contract.stakeAmount)} has been donated to ${contract.antiCharityCause}. Use this feeling to fuel your next attempt.`
        });
        break;
      case 'loss_pool':
        await forfeitFunds(contract.userId, contract.stakeAmount);
        break;
      case 'social':
        await notifyReferee(contract.refereeId, 'goal_failed', {
          userName: await getUserName(contract.userId),
          goalName: goal.name
        });
        break;
    }
  }
}

// Step 5: Non-Judgmental Failure Response
const failureResponse = {
  tone: 'Supportive',
  headline: "This round didn't go as planned. That's data, not defeat.",
  subtext: "Research shows people who try again with adjusted stakes succeed 67% of the time.",
  nextSteps: [
    {
      action: 'Try again with same goal',
      suggestion: 'Consider a smaller target or longer timeline'
    },
    {
      action: 'Try different stake type',
      suggestion: 'Social accountability might work better for you'
    },
    {
      action: 'Talk to your future self',
      suggestion: 'Reconnect with why this goal matters'
    }
  ],
  NO_shame_words: ['failed', 'loser', 'gave up', 'weak', 'pathetic']
};
```

**Stake Selection UI Flow:**

1. **Goal Creation** ‚Üí User sets target and deadline
2. **Stakes Prompt** ‚Üí "Add stakes to increase your success rate by 3x"
3. **Type Selection** ‚Üí Choose between Social, Anti-Charity, or Loss Pool
4. **Configuration** ‚Üí Set amount/referee based on type
5. **Confirmation** ‚Üí "This commitment is binding. Are you ready?"
6. **Active Tracking** ‚Üí Progress updates with stake reminder
7. **Share Your Commitment** ‚Üí Generate story card to share on social media (optional)

**Integration with Other Agents:**

- **GPS Re-Router**: When budget slip detected, remind user of active stakes
- **Future Self Simulator**: Letters mention active commitments for motivation
- **Ubuntu Manager**: Stakes can be paused for family emergencies (with referee approval)
- **Story Cards**: Generate shareable "commitment" cards when stakes are created, and "milestone" cards when goals are achieved

**Opik Metrics:**
- `StakeEffectiveness`: Goal completion rate by stake type
- `RefereeEngagement`: How often referees verify vs. ignore requests
- `CommitmentStrength`: Correlation between stake amount and success rate
- `RetryRate`: How often users try again after failed commitment
- `StakeTypeConversion`: Which stake types users choose most often

---

## Part 3: Financial Metrics Engine

### Cash Flow Score (0-100)

The Cash Flow Score is IKPA's primary financial health metric, calculated daily via NestJS Cron Job.

#### Formula

```typescript
const cashFlowScore = {
  // Component weights (must sum to 100%)
  weights: {
    savingsRate: 0.30,      // 30%
    runwayMonths: 0.25,     // 25%
    debtToIncome: 0.20,     // 20%
    incomeStability: 0.15,  // 15%
    dependencyRatio: 0.10   // 10% (NEW - cultural component)
  },

  // Component calculations
  components: {
    // Savings Rate Score (0-100)
    savingsRate: {
      formula: '(Monthly Savings / Monthly Income) * 100',
      scoring: {
        '0-5%': 20,
        '5-10%': 40,
        '10-15%': 60,
        '15-20%': 80,
        '20%+': 100
      }
    },

    // Runway Months Score (0-100)
    runwayMonths: {
      formula: 'Emergency Fund / Monthly Expenses',
      scoring: {
        '0-1 months': 20,
        '1-3 months': 40,
        '3-6 months': 60,
        '6-9 months': 80,
        '9+ months': 100
      }
    },

    // Debt-to-Income Score (0-100, inverse)
    debtToIncome: {
      formula: '(Monthly Debt Payments / Monthly Income) * 100',
      scoring: {
        '50%+': 20,
        '36-50%': 40,
        '20-35%': 60,
        '10-20%': 80,
        '0-10%': 100
      }
    },

    // Income Stability Score (0-100)
    incomeStability: {
      formula: '1 - (Standard Deviation of Last 6 Months / Average)',
      scoring: {
        'High variance (>30%)': 20,
        'Moderate variance (15-30%)': 60,
        'Low variance (<15%)': 100
      }
    },

    // Dependency Ratio Health Score (0-100, NEW)
    dependencyRatio: {
      formula: '(Total Family Support / Net Income) * 100',
      scoring: {
        '35%+': 40,      // High but not penalized harshly
        '10-35%': 80,    // Healthy moderate level
        '0-10%': 100     // Low family support
      }
    }
  },

  // Example calculation
  example: {
    savingsRate: { value: 12, score: 60 },
    runwayMonths: { value: 4.2, score: 60 },
    debtToIncome: { value: 18, score: 80 },
    incomeStability: { value: 8, score: 100 },
    dependencyRatio: { value: 21, score: 80 },

    calculation: '(60*0.30) + (60*0.25) + (80*0.20) + (100*0.15) + (80*0.10)',
    finalScore: 70
  }
};

// NestJS Cron Job
@Cron('0 2 * * *') // Run at 2 AM daily
async calculateDailyCashFlowScores() {
  const users = await this.userService.getAllActiveUsers();
  for (const user of users) {
    const score = await this.financeService.calculateCashFlowScore(user.id);
    await this.financeService.saveDailyScore(user.id, score);

    // Trigger alerts if significant change
    const previousScore = await this.financeService.getPreviousScore(user.id);
    if (Math.abs(score - previousScore) > 5) {
      await this.notificationService.sendScoreChangeAlert(user.id, previousScore, score);
    }
  }
}
```

### Simulation Engine (Dual-Path Monte Carlo)

```typescript
interface SimulationInput {
  currentSavingsRate: number;
  monthlyIncome: number;
  currentNetWorth: number;
  goalAmount: number;
  goalDeadline: Date;
  expectedReturnRate: number; // 7% default
  inflationRate: number;      // 5% Nigeria, 2% US
}

interface SimulationOutput {
  currentPath: {
    probability: number;
    projectedNetWorth: Record<string, number>;
    achieveGoalDate: Date | null;
  };
  optimizedPath: {
    probability: number;
    projectedNetWorth: Record<string, number>;
    achieveGoalDate: Date | null;
    requiredSavingsRate: number;
  };
}

// Monte Carlo with 10,000 simulations
function runDualPathSimulation(input: SimulationInput): SimulationOutput {
  const iterations = 10000;
  const currentPathResults = [];
  const optimizedPathResults = [];

  for (let i = 0; i < iterations; i++) {
    // Add random variance to returns (normal distribution)
    const variance = randomNormal(0, 0.15);

    // Current path simulation
    currentPathResults.push(
      simulatePath(input, input.currentSavingsRate, variance)
    );

    // Optimized path simulation (IKPA recommendations)
    const optimizedRate = Math.min(input.currentSavingsRate * 1.5, 0.35);
    optimizedPathResults.push(
      simulatePath(input, optimizedRate, variance)
    );
  }

  return {
    currentPath: aggregateResults(currentPathResults),
    optimizedPath: aggregateResults(optimizedPathResults)
  };
}
```

---

## Part 4: Opik Integration Strategy

### Why Opik Is Critical for Winning

Most hackathon teams use observability tools for **logging**. We use Opik for **evolution**. This is the winning edge for the "Best Use of Opik" prize.

### A. Distributed Tracing

Full "Cognitive Chain" tracing: Transaction ‚Üí Metrics ‚Üí Simulation ‚Üí LLM ‚Üí User Decision

```typescript
import { Opik } from 'opik';

const client = new Opik({
  apiKey: process.env.OPIK_API_KEY,
  apiUrl: 'https://www.comet.com/opik/api',
  projectName: 'ikpa-financial-coach',
  workspaceName: process.env.OPIK_WORKSPACE_NAME,
});

// Example: Full cognitive chain trace
async function handleSharkAudit(userId: string) {
  const trace = client.trace({
    name: 'shark_audit_cognitive_chain',
    input: { userId },
    metadata: { agent: 'shark_auditor', version: '1.0' }
  });

  // Span 1: Transaction Analysis
  const txSpan = trace.span({
    name: 'transaction_analysis',
    type: 'tool'
  });
  const subscriptions = await analyzeTransactions(userId);
  txSpan.end({ output: { subscriptionCount: subscriptions.length } });

  // Span 2: Metrics Calculation
  const metricsSpan = trace.span({
    name: 'calculate_savings_potential',
    type: 'tool'
  });
  const savingsPotential = calculateAnnualizedSavings(subscriptions);
  metricsSpan.end({ output: { potentialSavings: savingsPotential } });

  // Span 3: LLM Framing Generation
  const llmSpan = trace.span({
    name: 'generate_framing',
    type: 'llm',
    input: { subscriptions, savingsPotential }
  });
  const framing = await generateAnnualizedFraming(subscriptions);
  llmSpan.end({
    output: { framing },
    metadata: { model: 'claude-sonnet', tokens: 450 }
  });

  // Span 4: User Decision Recording
  const decisionSpan = trace.span({
    name: 'await_user_decision',
    type: 'tool'
  });
  // ... await user swipe decisions
  decisionSpan.end({ output: { decisionsRecorded: true } });

  trace.end({ output: { success: true, subscriptionsReviewed: subscriptions.length } });
  await client.flush();
}
```

### B. LLM-as-a-Judge with G-Eval

```typescript
// Four core metrics for IKPA evaluation

// Metric 1: InterventionSuccess (Binary)
class InterventionSuccess extends BaseMetric {
  score(datasetItem: DatasetItem, llmOutput: string): MetricResult {
    const userAction = datasetItem.userAction; // 'saved' | 'spent'
    const success = userAction === 'saved' ? 1.0 : 0.0;
    return {
      score: success,
      reason: userAction === 'saved'
        ? 'User chose to save instead of spend'
        : 'User proceeded with spending'
    };
  }
}

// Metric 2: ToneEmpathy (G-Eval, 1-5 scale)
class ToneEmpathy extends GEvalMetric {
  constructor() {
    super({
      name: 'ToneEmpathy',
      criteria: `Evaluate the empathy and supportiveness of the response.
        - Does it validate the user's feelings?
        - Does it avoid shame or judgment?
        - Does it feel like a supportive friend, not a lecturing parent?
        - Does it acknowledge difficulty while providing hope?`,
      scale: 5,
      model: 'gpt-4-turbo'
    });
  }
}

// Metric 3: CulturalSensitivity (G-Eval)
class CulturalSensitivity extends GEvalMetric {
  constructor() {
    super({
      name: 'CulturalSensitivity',
      criteria: `Evaluate cultural appropriateness for African users.
        - Does it respect family obligations as values, not problems?
        - Does it avoid Western-centric financial assumptions?
        - Does it acknowledge Ubuntu philosophy ("I am because we are")?
        - Does it frame family support as social capital investment?`,
      scale: 5,
      model: 'gpt-4-turbo'
    });
  }
}

// Metric 4: FinancialSafety (Guardrail)
class FinancialSafety extends BaseMetric {
  async score(datasetItem: DatasetItem, llmOutput: string): Promise<MetricResult> {
    const safetyCheck = await checkFinancialAdviceSafety(llmOutput);
    return {
      score: safetyCheck.isSafe ? 1.0 : 0.0,
      reason: safetyCheck.isSafe
        ? 'Advice is financially sound and safe'
        : `BLOCKED: ${safetyCheck.reason}`
    };
  }
}
```

### C. Optimizer Loop (The Winning Edge)

#### MetaPromptOptimizer: A/B Test Shark Auditor Framing

```typescript
import { MetaPromptOptimizer } from 'opik-optimizer';

// Test: Annual framing vs Monthly framing
const framingExperiment = {
  baseline: `You found a subscription: {{subscription_name}} at {{monthly_cost}}/month.
    Do you want to keep it or cancel it?`,

  variant: `You found a subscription: {{subscription_name}}.
    Monthly: {{monthly_cost}}
    Annual: {{annual_cost}} (that's {{percentage_of_rent}}% of your rent)
    Over 5 years: {{five_year_cost}}
    Do you want to keep it or cancel it?`
};

const optimizer = new MetaPromptOptimizer({
  model: 'claude-sonnet-4-20250514',
  reasoningModel: 'gpt-4-turbo'
});

const result = await optimizer.optimizePrompt({
  prompt: framingExperiment.baseline,
  dataset: subscriptionDecisionDataset,
  metric: new CancellationRate(),
  nSamples: 100,
  maxRounds: 10
});

// Expected: Annual framing increases cancellation rate by 40%
```

#### EvolutionaryOptimizer: Evolve Future Self Letter Prompts

```typescript
import { EvolutionaryOptimizer } from 'opik-optimizer';

const letterOptimizer = new EvolutionaryOptimizer({
  model: 'claude-sonnet-4-20250514',
  populationSize: 10,
  generations: 5
});

const evolvedPrompt = await letterOptimizer.evolve({
  basePrompt: futureSelLetterBasePrompt,
  dataset: letterEngagementDataset,
  metrics: [new ToneEmpathy(), new PostLetterSavingsChange()],
  survivalRate: 0.3
});

// Tracks prompt evolution across generations
// Shows which phrasings increase emotional resonance
```

#### GEPA: Optimize GPS Re-Router Tool Selection

```typescript
import { GEPA } from 'opik-optimizer';

const routerOptimizer = new GEPA({
  model: 'claude-sonnet-4-20250514',
  tools: [
    { name: 'time_adjustment', description: 'Extend goal deadline' },
    { name: 'rate_adjustment', description: 'Increase savings rate' },
    { name: 'freeze_protocol', description: 'Pause category spending' }
  ]
});

const optimizedToolSelection = await routerOptimizer.optimize({
  dataset: recoveryPathDataset,
  metric: new GoalSurvivalRate(),
  maxIterations: 20
});

// Learns which recovery path works best for different user profiles
// E.g., "Users with high income stability prefer rate_adjustment"
```

### D. Opik Dashboard Must-Haves for Demo

1. **Tracing View**: Complete cognitive chain with token counts
2. **G-Eval Scores**: Real-time ToneEmpathy and CulturalSensitivity
3. **Experiment Comparison**: Annual vs Monthly framing A/B results
4. **Learning Curve**: Show prompt evolution over development period
5. **Cost Analysis**: Token usage optimization insights

---

## Part 5: 4-Week Execution Plan

| Week | Focus | Deliverables |
|------|-------|--------------|
| **Week 1 (Jan 13-19)** | Foundation & Financial Metrics | Cash Flow Score, Simulation Engine, Opik distributed tracing, Database schema |
| **Week 2 (Jan 20-26)** | Shark Auditor, GPS Re-Router & Commitment Engine | Subscription detection, Tinder UI, Recovery paths, Commitment contracts, Stakes UI |
| **Week 3 (Jan 27-Feb 2)** | Future Self & Ubuntu Manager | Letter generator, Dependency ratio, G-Eval metrics, Time slider visualization |
| **Week 4 (Feb 3-10)** | Polish & Submission | UI polish, Demo video, Documentation, Opik dashboard screenshots |

### Week 1: Foundation & Financial Metrics

**Days 1-2:**
- [ ] Set up Opik account and TypeScript SDK integration
- [ ] Create OpikService wrapper class with distributed tracing
- [ ] Wire basic tracing to existing endpoints

**Days 3-4:**
- [ ] Implement Cash Flow Score calculator with all 5 components
- [ ] Create NestJS Cron Job for daily score calculation
- [ ] Build score history tracking

**Days 5-7:**
- [ ] Implement Dual-Path Monte Carlo Simulation Engine
- [ ] Create simulation visualization data structures
- [ ] Test with sample user data
- [ ] Verify all Opik traces appear in dashboard

### Week 2: Shark Auditor, GPS Re-Router & Commitment Engine

**Days 8-10:**
- [ ] Implement Shark Auditor regex pattern matching
- [ ] Build anomaly detection for zombie subscriptions
- [ ] Create annualized framing logic
- [ ] Design Tinder-style swipe UI component

**Days 11-12:**
- [ ] Implement GPS Re-Router webhook triggers
- [ ] Build probability recalculation engine
- [ ] Create 3 recovery path generators
- [ ] Implement non-judgmental messaging

**Days 13-14:**
- [ ] Implement Commitment Device Engine core contracts
- [ ] Build stake type selection UI (Social, Anti-Charity, Loss Pool)
- [ ] Create referee invitation and notification system
- [ ] Implement stake enforcement logic
- [ ] Set up MetaPromptOptimizer A/B experiment for commitment messaging

### Week 3: Future Self & Ubuntu Manager

**Days 15-17:**
- [ ] Implement Future Self letter generator
- [ ] Create 60-year-old persona prompt
- [ ] Build time slider visualization (6mo ‚Üí 20yr)
- [ ] Implement Dual-Path comparison view

**Days 18-21:**
- [ ] Implement Ubuntu Manager categorization
- [ ] Build Dependency Ratio calculator
- [ ] Create Risk Gauge (traffic light) component
- [ ] Implement G-Eval metrics (ToneEmpathy, CulturalSensitivity)
- [ ] Run EvolutionaryOptimizer on letter prompts

### Week 4: Polish & Submission

**Days 22-24:**
- [ ] UI polish across all features
- [ ] Performance optimization
- [ ] Bug fixes from testing

**Days 25-27:**
- [ ] Record demo video (5 minutes)
- [ ] Write submission documentation
- [ ] Capture Opik dashboard screenshots
- [ ] Create learning curve visualization

**Days 28 (Feb 10):**
- [ ] Final testing
- [ ] Submit to hackathon
- [ ] Prepare for potential presentation

---

## Part 6: MVP Prioritization

### Tier 1: Must Ship (Demo-Critical)

| # | Feature | Agent | Why Critical |
|---|---------|-------|--------------|
| 1 | **Cash Flow Score** | Foundation | Single metric for financial health |
| 2 | **Simulation Engine (Dual-Path)** | Foundation | Powers Future Self visualizations |
| 3 | **Future Self Letter Generator** | Future Self Simulator | "I talked to my 60-year-old self" |
| 4 | **Commitment Device Engine** | Stakes Enforcer | "3x goal completion with real stakes" |
| 5 | **Opik Distributed Tracing** | All | "We traced every cognitive step" |
| 6 | **One G-Eval Metric (ToneEmpathy)** | All | "Our AI learns to be more empathetic" |

### Tier 2: Should Ship (High Impact)

| # | Feature | Agent | Why Important |
|---|---------|-------|---------------|
| 7 | **Tinder-Style Subscription Swiper** | Shark Auditor | Viral demo moment |
| 8 | **GPS Recovery Paths** | GPS Re-Router | "It helped me recover, not quit" |
| 9 | **Dependency Ratio + Risk Gauge** | Ubuntu Manager | Africa differentiation |
| 10 | **Opik Optimizer Experiment** | All | "Our prompts EVOLVED" |

### Tier 3: Cut If Behind

| # | Feature | Why Cuttable |
|---|---------|--------------|
| 11 | GEPA Tool Optimization | Advanced‚Äîcan show concept without full implementation |
| 12 | Full A/B Testing Pipeline | Can show single experiment instead |
| 13 | Push Notifications | Can simulate in demo |
| 14 | Time Slider Animation | Static comparison sufficient for demo |

### Cutoff Rules

- **Day 14 Checkpoint:** If behind, cut Tier 3 entirely
- **Day 21 Checkpoint:** If still behind, simplify Tier 2 features
- **Day 25:** Feature freeze‚Äîpolish only

---

## Part 7: Demo Script (5 Minutes)

### The Narrative
"Meet Aisha. She's 28, earns ‚Ç¶400K/month, and wants to save ‚Ç¶2M for a house down payment. Watch as IKPA defeats the five failure modes that kill 91% of resolutions."

### Demo Flow

**1. Hook (30s)**

"91% of financial resolutions fail. Not because people lack data‚ÄîMint gave them dashboards. Not because they lack knowledge‚ÄîYNAB taught them budgeting. They fail because of five specific failure modes. IKPA defeats each one."

**2. Failure Mode 1: Invisible Leakage ‚Üí Shark Auditor (1min)**

[Show subscription detection screen]

"First, the Shark Auditor finds Aisha's invisible leaks."

[Swipe interface appears]
- Netflix: ‚Ç¶5,000/month ‚Üí ‚Ç¶60,000/year. Swipe left to cancel.
- Gym membership (unused for 5 months): ZOMBIE. ‚Ç¶15,000/month ‚Üí ‚Ç¶180,000/year.

[Show annualized framing]
"These zombie subscriptions cost ‚Ç¶240,000/year‚Äîthat's 12% of her house goal. One swipe to kill each zombie."

[User swipes left on both]
"Total recovered: ‚Ç¶240,000/year. The Shark Auditor defeated invisible leakage."

**3. Failure Mode 2: Failure Spiral ‚Üí GPS Re-Router (1min)**

[Show budget exceed notification]

"Week 3: Aisha overspent on entertainment by 40%. In traditional apps, she'd see this:"

[Show scary red alert]
"YOU EXCEEDED YOUR BUDGET BY 40%"

"This triggers shame ‚Üí avoidance ‚Üí abandonment. The failure spiral. But IKPA's GPS Re-Router shows this instead:"

[Show GPS Re-Router interface]
"You made a wrong turn. Let's recalculate your route."

[Show 3 recovery paths]
1. **Time Adjustment:** Extend goal by 2 weeks ‚Üí 78% probability restored
2. **Rate Adjustment:** Add ‚Ç¶5K/week for one month ‚Üí 81% probability
3. **Freeze Protocol:** Pause entertainment for 2 weeks ‚Üí 85% probability

"Aisha picks Rate Adjustment. She's back on track. The GPS Re-Router defeated the failure spiral."

**4. Failure Mode 3: Temporal Disconnect ‚Üí Future Self Simulator (1min)**

[Show time slider at 20 years]

"Now let's see Aisha's two futures."

[Dual-path visualization]
- Current Path: ‚Ç¶8M net worth at age 48
- IKPA Path: ‚Ç¶28M net worth at age 48

"But numbers don't motivate. Narratives do. Here's Aisha's letter from 2045:"

[Display letter from 60-year-old Aisha]

"Dear Aisha,
I'm writing this from the balcony of our flat in Victoria Island. Yes, OUR flat‚Äîwe own it now.
That ‚Ç¶20,000 you saved in January 2026? It became ‚Ç¶180,000 by now.
Keep going. I'm proof it works.
Love, Aisha (Age 60)"

"The Future Self Simulator defeated temporal disconnect."

**5. Failure Mode 4: Cultural Blindness ‚Üí Ubuntu Manager (45s)**

[Show family transfer notification]

"Aisha's mom needs ‚Ç¶100K for medical bills. Western apps would show this as a budget problem. IKPA's Ubuntu Manager shows this:"

[Show Ubuntu Manager response]
"Family comes first‚Äîthat's not a bug, it's a feature of who you are."

[Show Dependency Ratio gauge]
"Your dependency ratio: 21% (Healthy Orange Zone)"

[Show adjustment options]
"Use emergency fund, adjust timeline, or reduce this month's savings‚Äîall guilt-free."

"The Ubuntu Manager defeated cultural blindness."

**6. Failure Mode 5: Commitment Decay ‚Üí Commitment Device Engine (45s)**

[Show goal creation screen]

"Aisha sets her goal: Save ‚Ç¶2M for a house down payment by December. But here's the twist‚ÄîIKPA asks:"

[Show stakes selection UI]
"Want to increase your success rate by 3x? Add stakes to your commitment."

[Show three stake options]
- **Social Accountability**: "My sister Funke will be my referee"
- **Anti-Charity Stakes**: "‚Ç¶50,000 donated to [cause I oppose] if I fail"
- **Loss Pool**: "Lock ‚Ç¶100,000 until I reach my goal"

[User selects Social Accountability]

"Aisha chooses her sister as referee. Now Funke receives weekly progress updates and verifies the final result."

[Show commitment confirmation]
"Research shows users with stakes are 3x more likely to achieve their goals. The Commitment Device Engine defeated commitment decay."

[Show story card preview]
"And Aisha can share her commitment journey‚Äîa beautiful story card for social media. Viral growth built into every achievement."

**7. Opik Showcase: The Winning Edge (45s)**

[Switch to Opik Dashboard]

"Now here's how we win 'Best Use of Opik':"

[Show distributed trace]
"Every agent action‚Äîfrom transaction detection to LLM response to user decision‚Äîis traced in Opik."

[Show G-Eval scores]
"We use LLM-as-a-Judge with G-Eval. This measures ToneEmpathy‚Äîhow supportive our AI sounds."

[Show learning curve]
"And here's the winning edge: Our prompts EVOLVE."

Week 1: ToneEmpathy score: 3.2/5
Week 4: ToneEmpathy score: 4.6/5

"We used MetaPromptOptimizer to automatically improve our Shark Auditor framing. Annual framing increased subscription cancellation by 43%."

**8. Emotional Close (15s)**

"IKPA doesn't track money‚Äîit fights for you.
Five failure modes. Five agents. One goal: Make Aisha's 60-year-old self proud.
Thank you."

---

## Part 8: Technical Architecture

### Module Structure

```
apps/api/src/
‚îú‚îÄ‚îÄ modules/
‚îÇ   ‚îú‚îÄ‚îÄ ai/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ai.module.ts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ai.service.ts
‚îÇ   ‚îÇ   ‚îÇ
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ agents/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ shark-auditor.agent.ts      # Subscription detection
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ gps-rerouter.agent.ts       # Recovery path generation
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ future-self.agent.ts        # Letter from 2045
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ubuntu-manager.agent.ts     # Cultural context
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ commitment-device.agent.ts  # Stakes enforcement
‚îÇ   ‚îÇ   ‚îÇ
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ opik/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ opik.service.ts             # Opik client wrapper
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ metrics/
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ intervention-success.metric.ts
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ tone-empathy.metric.ts   # G-Eval
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ cultural-sensitivity.metric.ts  # G-Eval
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ financial-safety.metric.ts
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ stake-effectiveness.metric.ts  # Commitment tracking
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ optimizer/
‚îÇ   ‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ framing-optimizer.ts     # MetaPromptOptimizer
‚îÇ   ‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ letter-optimizer.ts      # EvolutionaryOptimizer
‚îÇ   ‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ tool-optimizer.ts        # GEPA
‚îÇ   ‚îÇ   ‚îÇ
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ prompts/
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ shark-auditor.prompt.ts
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ gps-rerouter.prompt.ts
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ future-self.prompt.ts
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ ubuntu-manager.prompt.ts
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ commitment-device.prompt.ts
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ finance/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ calculators/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ cash-flow-score.ts
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ simulation-engine.ts         # Dual-Path Monte Carlo
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ dependency-ratio.ts
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ subscription-detector.ts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ finance.service.ts
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ finance.cron.ts                  # Daily calculations
‚îÇ   ‚îÇ
‚îÇ   ‚îî‚îÄ‚îÄ story-cards/                         # Addon: Shareable content
‚îÇ       ‚îú‚îÄ‚îÄ story-cards.module.ts
‚îÇ       ‚îú‚îÄ‚îÄ story-cards.service.ts           # Card generation logic
‚îÇ       ‚îú‚îÄ‚îÄ story-cards.controller.ts
‚îÇ       ‚îî‚îÄ‚îÄ templates/
‚îÇ           ‚îú‚îÄ‚îÄ future-self.template.ts      # "I talked to my 60-year-old self"
‚îÇ           ‚îú‚îÄ‚îÄ commitment.template.ts       # "I put my money where my goals are"
‚îÇ           ‚îú‚îÄ‚îÄ milestone.template.ts        # "Goal Achieved!"
‚îÇ           ‚îî‚îÄ‚îÄ recovery.template.ts         # "I made a wrong turn. Then I recalculated."
```

### API Endpoints

```typescript
// Shark Auditor endpoints
GET  /v1/shark/subscriptions          // Get detected subscriptions
POST /v1/shark/subscriptions/:id/cancel  // Process cancellation
POST /v1/shark/audit                  // Trigger manual audit

// GPS Re-Router endpoints
POST /v1/gps/recalculate              // Recalculate after budget exceed
GET  /v1/gps/recovery-paths           // Get 3 recovery options
POST /v1/gps/recovery-paths/:id/select  // Select a recovery path

// Future Self endpoints
GET  /v1/future-self/simulation       // Get dual-path projection
GET  /v1/future-self/letter           // Get letter from 2045
GET  /v1/future-self/timeline/:years  // Get projection at specific year

// Ubuntu Manager endpoints
GET  /v1/ubuntu/dependency-ratio      // Get current ratio
POST /v1/ubuntu/family-support        // Add family obligation
GET  /v1/ubuntu/adjustments           // Get non-judgmental adjustments

// Commitment Device Engine endpoints
POST /v1/commitment/stakes            // Create commitment contract with stakes
GET  /v1/commitment/stakes/:goalId    // Get stakes for a specific goal
PUT  /v1/commitment/stakes/:id        // Update stake configuration
DELETE /v1/commitment/stakes/:id      // Remove stakes (before deadline only)
POST /v1/commitment/verify/:id        // Referee verification endpoint
GET  /v1/commitment/referee/pending   // Get pending verifications for referee
POST /v1/commitment/referee/invite    // Invite referee via email

// Shareable Story Cards endpoints (addon)
POST /v1/story-cards/generate         // Generate story card for sharing
GET  /v1/story-cards/:id              // Get generated story card
GET  /v1/story-cards/user/:userId     // Get all story cards for user
POST /v1/story-cards/:id/share        // Track share event by platform

// Financial Metrics endpoints
GET  /v1/finance/score                // Get Cash Flow Score
GET  /v1/finance/score/history        // Get score history
GET  /v1/finance/simulation           // Get Monte Carlo results
```

### Environment Variables

```env
# API Configuration
ANTHROPIC_API_KEY=your-anthropic-key
DATABASE_URL=postgresql://...
REDIS_URL=redis://...

# Opik Configuration (Required for Best Use of Opik prize)
OPIK_API_KEY=your-opik-key
OPIK_URL_OVERRIDE=https://www.comet.com/opik/api
OPIK_PROJECT_NAME=ikpa-financial-coach
OPIK_WORKSPACE_NAME=your-workspace

# Feature Flags
ENABLE_SHARK_AUDITOR=true
ENABLE_GPS_REROUTER=true
ENABLE_FUTURE_SELF=true
ENABLE_UBUNTU_MANAGER=true
ENABLE_OPIK_OPTIMIZER=true
```

---

## Part 9: Risk Mitigation

### Technical Risks

| Risk | Impact | Mitigation |
|------|--------|------------|
| Opik TypeScript SDK issues | High | Fall back to REST API; have backup code ready |
| Claude API rate limits | Medium | Implement caching; reduce demo load; use mock responses |
| Simulation engine too slow | Medium | Pre-compute projections; cache results |
| Tinder UI bugs | Low | Fallback to simple list with buttons |

### Scope Risks

| Risk | Impact | Mitigation |
|------|--------|------------|
| Feature creep | High | Strict MVP adherence; Day 14/21 checkpoints |
| Over-engineering | Medium | "Demo-ready" not "production-ready" mindset |
| Time overrun | High | Cut Tier 3 at Day 14; simplify Tier 2 at Day 21 |

### Demo Risks

| Risk | Impact | Mitigation |
|------|--------|------------|
| Live API failure | Critical | Pre-record demo video; have offline fallback |
| Opik dashboard unimpressive | High | Pre-populate with 100+ traces before demo |
| Judges don't understand Africa context | Medium | Lead with universal "91% failure rate" hook |

### Safety Risks

| Risk | Impact | Mitigation |
|------|--------|------------|
| Bad financial advice | Critical | FinancialSafety guardrail blocks unsafe responses |
| Culturally insensitive output | High | CulturalSensitivity G-Eval metric |
| Shame-inducing messaging | Medium | ToneEmpathy G-Eval metric; banned word list |

### Contingency Timeline

| Checkpoint | If Behind Schedule |
|------------|-------------------|
| **Day 14** | Cut all Tier 3 features; focus on Tier 1+2 |
| **Day 21** | Simplify Tier 2; ensure Tier 1 is polished |
| **Day 25** | Feature freeze; polish and documentation only |
| **Day 27** | Record demo video with whatever is ready |

---

## Part 10: Research-Backed Statistics

| Statistic | Source | Design Implication |
|-----------|--------|-------------------|
| **91% fail** at resolutions | Journal of Clinical Psychology | Standard tools don't work |
| **88% quit** within 2 weeks | Drive Research 2024 | Early intervention (GPS Re-Router) is critical |
| **16% more likely to save** | MIT Future Self Study | Future Self letters work |
| **84% underestimate** subscription costs | Consumer Reports | Annualized framing needed |
| **"What-The-Hell Effect"** | Polivy & Herman | One slip leads to total abandonment |
| **Approach goals 2x** success | PMC Chi-square study | Reframe avoidance ‚Üí approach |

---

## Part 11: References

### Behavior Change & Resolutions
- [PMC: New Year's Resolution Study](https://pmc.ncbi.nlm.nih.gov/articles/PMC7725288/)
- [Journal of Clinical Psychology: Resolution Success Rates](https://party.alibaba.com/newyear/how-many-people-accomplish-new-year-resolution-goals-scholarly-article)
- [CBS News: Why Resolutions Fail](https://www.cbsnews.com/news/new-years-resolutions-tips-why-they-fail/)

### AI & Behavior Change
- [MIT Media Lab: Future You Project](https://www.media.mit.edu/projects/future-you/overview/)
- [MIT News: Future Self Research](https://news.mit.edu/2024/ai-simulation-gives-people-glimpse-potential-future-self-1001)
- [Nature: Chatbot Meta-Analysis](https://www.nature.com/articles/s41746-023-00856-1)

### Behavioral Economics
- [ScienceDirect: AI Nudging](https://www.sciencedirect.com/science/article/abs/pii/B9780128194713000021)
- [Learning Loop: Commitment Devices](https://learningloop.io/plays/psychology/commitment-devices)
- ["What-The-Hell Effect" - Polivy & Herman Research](https://en.wikipedia.org/wiki/What-the-hell_effect)

### Opik & Observability
- [Opik Documentation](https://www.comet.com/docs/opik/)
- [Opik Agent Optimizer](https://www.comet.com/site/products/opik/features/automatic-prompt-optimization/)
- [Opik GitHub](https://github.com/comet-ml/opik)
- [G-Eval Paper](https://arxiv.org/abs/2303.16634)

---

*This document serves as the strategic blueprint for IKPA's participation in the "Commit to Change" hackathon. All features, timelines, and technical decisions should reference this document.*

**Last Updated:** January 2026
**Timeline:** 4 weeks (January 13 - February 10, 2026)
**Maximum Prize Potential:** $10,000
